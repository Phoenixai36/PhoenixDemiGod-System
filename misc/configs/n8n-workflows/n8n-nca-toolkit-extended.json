{
  "name": "NCA Toolkit Extended Phoenix",
  "nodes": [
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "nca-base-url",
              "name": "nca_base_url",
              "value": "https://sea-turtle-app-nlak2.ondigitalocean.app/v1/",
              "type": "string"
            },
            {
              "id": "phoenix-api-key",
              "name": "api_key",
              "value": "phoenix-hydra-prod-2025",
              "type": "string"
            },
            {
              "id": "marketplace-config",
              "name": "marketplace",
              "value": "{\"aws\": true, \"cloudflare\": true, \"huggingface\": true}",
              "type": "string"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [120, 100],
      "id": "phoenix-variables",
      "name": "Phoenix Variables"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "{{ $('Phoenix Variables').first().json.nca_base_url }}video/caption/enterprise",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [{
            "name": "x-api-key",
            "value": "{{ $('Phoenix Variables').first().json.api_key }}"
          }]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "{\n  \"video_url\": \"{{ $json.video_input }}\",\n  \"settings\": {\n    \"brand_colors\": {\n      \"primary\": \"#66ff74\",\n      \"secondary\": \"#FFFFFF\"\n    },\n    \"enterprise_features\": {\n      \"white_label\": true,\n      \"custom_fonts\": true,\n      \"api_tracking\": true\n    },\n    \"monetization\": {\n      \"usage_tracking\": true,\n      \"billing_integration\": \"aws_marketplace\"\n    }\n  },\n  \"client_id\": \"{{ $json.client_id }}\"\n}"
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [420, 200],
      "id": "enterprise-caption",
      "name": "Enterprise Caption API"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "{{ $('Phoenix Variables').first().json.nca_base_url }}ffmpeg/compose/marketplace",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [{
            "name": "x-api-key",
            "value": "{{ $('Phoenix Variables').first().json.api_key }}"
          }]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "{\n  \"inputs\": [\n    {\n      \"file_url\": \"{{ $json.input_video }}\",\n      \"marketplace_source\": \"{{ $json.marketplace }}\"\n    }\n  ],\n  \"phoenix_branding\": {\n    \"watermark\": \"{{ $json.white_label ? false : true }}\",\n    \"credits\": \"Powered by Phoenix Hydra\"\n  },\n  \"billing\": {\n    \"track_usage\": true,\n    \"cost_per_second\": 0.05,\n    \"marketplace_fee\": \"{{ $json.marketplace === 'aws' ? 0.20 : 0.10 }}\"\n  }\n}"
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [420, 350],
      "id": "marketplace-ffmpeg",
      "name": "Marketplace FFmpeg Compose"
    }
  ]
}
